plugins {
    id 'java'
    id 'application'
}

String buildNumber = 'git rev-list --count HEAD'.execute().text.trim();

group 'com.github.mouse0w0'
version "0.0.5.${buildNumber}-SNAPSHOT"

sourceCompatibility = targetCompatibility = 1.8
mainClassName = 'com.github.mouse0w0.peach.Peach'

repositories {
    jcenter()
    mavenCentral()
    maven { url 'https://jitpack.io' }
    mavenLocal()
}

dependencies {
    compile 'com.google.guava:guava:29.0-jre'
    compile 'org.apache.commons:commons-lang3:3.10'
    compile 'commons-io:commons-io:2.6'
    compile 'org.joml:joml:1.9.25'
    compile 'com.google.code.gson:gson:2.8.6'
    compile 'org.dom4j:dom4j:2.1.3'

//    compile 'org.freemarker:freemarker:2.3.30'

    compile 'com.github.promeg:tinypinyin:2.0.3'

    compile 'com.github.mouse0w0:eventbus:2.4.4'
    compile 'com.github.mouse0w0:version:1.4.0'
    compile 'com.github.mouse0w0:i18n:1.0.2'

//    compile 'org.controlsfx:controlsfx:8.40.17'
//    compile 'com.dlsc.formsfx:formsfx-core:8.4.0'
//    compile 'com.dlsc.preferencesfx:preferencesfx-core:8.6.0'
//    compile 'org.fxmisc.richtext:richtextfx:0.10.5'

    compile 'org.ow2.asm:asm-commons:8.0.1'
    compile 'org.ow2.asm:asm-util:8.0.1'

    compile 'org.slf4j:slf4j-api:1.7.30'

    implementation 'org.apache.logging.log4j:log4j-slf4j-impl:2.13.3'

    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.4.1'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.4.1'

    testRuntimeOnly 'org.slf4j:slf4j-simple:1.7.30'
}

jar {
    String gitBranch = 'git name-rev --name-only HEAD'.execute().text.trim()
    String gitVersion = 'git rev-parse --short HEAD'.execute().text.trim()
    manifest.attributes([
            "Main-Class"              : mainClassName,
            "Implementation-Title"    : rootProject.name,
            "Implementation-Version"  : project.version,
            "Implementation-Timestamp": new Date().format("yyyy-MM-dd'T'HH:mm:ssZ"),
            "Git-Branch"              : gitBranch,
            "Git-Version"             : gitVersion,
            "Git-BuildNumber"         : buildNumber
    ])
}